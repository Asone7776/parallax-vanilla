"use strict";var test=require("./test");test(),function(a){var b=function(){var b=["3g2","3gp","asf","avi","flv","h264","m4v","mov","mp4","mpg","mpeg","rm","srt","swf","vow","vob","wmv"],c={};c.stringOfIntegers=function(a){return/^[0-9]+$/.test(a)},c.transform=function(a,b){a.style.webkitTransform=b,a.style.MozTransform=b,a.style.msTransform=b,a.style.OTransform=b,a.style.transform=b},c.paraArr=[],c.windowProps={scrollTop:a.scrollY,windowHeight:a.innerHeight,windowMidHeight:a.innerHeight/2},c.updateWindowProps_OnRaf=function(){c.windowProps.scrollTop=a.scrollY||document.documentElement.scrollTop},c.updateWindowProps_OnResize=function(){c.windowProps.scrollTop=a.scrollY||document.documentElement.scrollTop,c.windowProps.windowHeight=a.innerHeight,c.windowProps.windowMidHeight=a.innerHeight/2},c.offsetTop=function(b){var c=b.getBoundingClientRect().top,d=a.pageYOffset||document.documentElement.scrollTop;return c+d},c.init=function(b){var d={container:{"class":"pv-container",height:"250px"},block:{"class":"pv-block",speed:-Math.PI,mediatype:"image",mediapath:void 0}};b=b||d,b.container=b.container||d.container,b.container["class"]=b.container["class"]?b.container["class"].toLowerCase():d.container["class"],b.container.height=b.container.height||d.container.height,b.block=b.block||d.block,b.block["class"]=b.block["class"]?b.block["class"].toLowerCase():d.block["class"],b.block.speed=b.block.speed||d.block.speed,b.block.mediatype=b.block.mediatype?b.block.mediatype.toLowerCase():d.block.mediatype,b.block.mediapath=b.block.mediapath||d.block.mediapath;for(var e=document.getElementsByClassName(b.container["class"]),f=0;f<e.length;f++){var g={},h={};h.el=e[f],h.offset=c.offsetTop(h.el);var i=h.el.getAttribute("pv-height");if(null==i)h.el.style.height=b.container.height;else if(c.stringOfIntegers(i))h.el.style.height=i+"px";else{var j=i.substr(i.length-2,i.length);if("px"!=j&&"vh"!=j)throw new Error("Invalid height");h.el.style.height=i}h.height=h.el.clientHeight,g.container=h,g.blocks=[];for(var k=e[f].getElementsByClassName(b.block["class"]),l=0;l<k.length;l++){var m={};m.el=k[l];var n=m.el.getAttribute("pv-speed");null==n?m.speed=b.block.speed:0==n||0==n?m.speed=b.block.speed:m.speed=n;var o=m.el.getAttribute("pv-mediapath"),p=m.el.getAttribute("pv-mediatype");if(o)if(m.mediapath=o,p&&(m.mediatype=p),c.isVideo(p,o)){var q=document.createElement("video");q.src=o,q.autoPlay=!0,q.type="video/"+extension,q.loop=!0,q.muted=!0,m.el.appendChild(q),m.isPlaying=!0,q.play()}else m.el.style.backgroundImage="url('"+o+"')";var r=a.getComputedStyle(m.el).getPropertyValue("background-image");if("image"===m.mediatype&&"none"==r)return;var s=0,t=0,u=0;h.offset<c.windowProps.windowHeight?(t=(h.height+h.offset)/Math.abs(m.speed),m.speed>0?(s=-Math.abs(h.offset),u=h.height+h.offset):u=t+h.height):(t=(h.height+c.windowProps.windowHeight)/Math.abs(m.speed),u=t+h.height,m.speed>0?(s=-t,u=h.height+c.windowProps.windowHeight/Math.abs(m.speed)):u=t+h.height),Math.abs(s)>=Math.abs(u)&&(u=Math.abs(s)+1),m.el.style.setProperty("padding-bottom",u+"px",null),m.el.style.setProperty("margin-top",s+"px",null),g.blocks.push(m)}c.paraArr.push(g)}},c.isInViewport=function(a,b){return c.windowProps.scrollTop+c.windowProps.windowHeight-a>0&&c.windowProps.scrollTop<a+b},c.getExtension=function(a){a.substr(a.lastIndexOf(".")+1,a.length).toLowerCase()},c.isVideo=function(a,d){return"video"===a||b.indexOf(c.getExtension(d))!==-1},c.translate=function(){for(var a=0;a<c.paraArr.length;a++){var b=c.paraArr[a].container,d=void 0;if(c.isInViewport(b.offset,b.height)){d=b.offset<c.windowProps.windowHeight?c.windowProps.scrollTop:c.windowProps.windowHeight-b.offset+c.windowProps.scrollTop;for(var e=0;e<c.paraArr[a].blocks.length;e++){var f=c.paraArr[a].blocks[e];c.transform(f.el,"translate3d(0,"+Math.round(d/f.speed)+"px, 0)")}}else for(var g=0;g<c.paraArr[a].blocks.length;g++){var h=c.paraArr[a].blocks[g];h.isPlaying&&h.el.firstChild.pause()}}},a.onresize=function(){c.updateWindowProps_OnResize(),c.init()},a.raf=function(){return a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame||function(b){a.setTimeout(b,1e3/60)}}();var d=function e(){c.updateWindowProps_OnRaf(),c.translate(),raf(e)};return raf(d),c};"undefined"==typeof pv&&(a.pv=b())}(window);